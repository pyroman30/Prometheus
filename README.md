# Prometheus
Мы поднимем тестовые Grafana, Prometheus, Node exporter. Убедись, что у тебя на машине стоит docker, и docker-compose. В противном случае установи их.
Cкачаем docker-compose.yaml
Создай папку prometheus:
  mkdir prometheus/prometheus.yml
Создай папку Grafana:
  mkdir grafana/datasource.yml
Запускаем docker-compose:
  docker-compose up -d
Отлично, теперь у нас есть тестовая среда.
Начнём с того, что же всё-таки у нас используется. Для отображения графиков изпользуется grafana, для хранения и управления метриками используется prometheus, 
а сами метрики на машине генерирует node_exporter.
Это обычная утилита, которая обращается к твоей системе, и генерирует метрики, которые понятны prometheus.
Отдаёт он их по /metrics.
Тоесть он собирает, например, сколько сейчас свободной памяти, записывает её под формат, который понимает prometheus, например:
node_pressure_memory_stalled_seconds_total 0

Попробуй запустить команду:
curl localhost:9100/metrics
Ты увидишь все метрики, которые сейчас отдаёт node_exporter на твоей системе.
Prometheus умеет как сам ходить на нужный хост и забирать метрики, у, например, node_exporter. Это называется Pull модель. Так и exporter'ы умеют сами посылать метрики в prometheus. Это называется Push модель.
Кстати забыл сказать, exporter'ов существует очень много. Обычно это просто утилита, которая знает как обратиться к приложению, и посмотреть нужные данные.
Например наш node_exporter обращается к нашей системе и собирает нужные метрики.

Давай-ка попробуем визуализировать данные, в этом нам пригодится Grafana.

http://localhost:3000
Логин - admin
Пароль - grafana

Графана оперирует таким понятием, как Dashboard (дашборд).
Их есть много готовых.
У grafana есть каталог дашбордов, вот тут - 
https://grafana.com/grafana/dashboards/

Давай резюмируем:
Мы подняли docker контейнер с node_exporter, который собирает данные с твоей системы, и отображает их по /metrics.
Далее prometheus по Pull модели идёт, и собирает их, тк у него есть такая Job в конфиге.
Потом он их сохраняет.
После этого Grafana, в которую мы добавили нужный Dashboard с подходящими графиками, обращается к prometheus за данными, и рисует графики.
 
